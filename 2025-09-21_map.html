<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9/21 ê³ ê³ ì‹±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #331919;
            background: #f8f9fa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .view-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .view-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid #e9ecef;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            font-weight: 500;
        }

        .view-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }

        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .search-box:focus {
            outline: none;
            border-color: #007bff;
        }

        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #e9ecef;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .filter-btn:hover, .filter-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }

        .sort-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .sort-select {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            background: white;
        }

        #mapContainer {
            display: none;
            width: 100%;
            height: 600px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .map-info-window {
            padding: 10px;
            min-width: 200px;
        }

        .map-info-title {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
            color: #333;
        }

        .map-info-hours {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .map-info-priority {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 11px;
            margin-bottom: 5px;
        }

        .map-info-link {
            display: inline-block;
            margin-top: 5px;
            padding: 4px 8px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 11px;
        }

        .popup-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .popup-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .popup-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .popup-header {
            background: #f0f4f8;
            color: #4a5568;
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e2e8f0;
        }

        .popup-title {
            font-size: 18px;
            font-weight: bold;
        }

        .priority-badge {
            background: rgba(51, 51, 51, 0.1);
            color: #333;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            border: 1px solid rgba(51, 51, 51, 0.2);
        }

        .priority-high { background: #ffb3b3; }
        .priority-medium { background: #ffd9b3; }
        .priority-low { background: #c8e6c9; }

        .expand-icon {
            font-size: 20px;
            transition: transform 0.3s;
        }

        .expanded .expand-icon {
            transform: rotate(180deg);
        }

        .popup-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .expanded .popup-content {
            max-height: 1000px;
        }

        .popup-details {
            padding: 20px;
        }

        .detail-section {
            margin-bottom: 15px;
        }

        .detail-label {
            font-weight: bold;
            color: #555;
            margin-bottom: 5px;
        }

        .detail-value {
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .status-ongoing { background: #d4edda; color: #155724; }
        .status-ending { background: #fff3cd; color: #856404; }
        .status-ended { background: #f8d7da; color: #721c24; }

        .waiting-info {
            background: #e7f3ff;
            border: 2px solid #b3d7ff;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
        }

        .waiting-icon {
            color: #0066cc;
            margin-right: 8px;
        }

        .url-links {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .url-link {
            background: #007bff;
            color: white;
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            transition: background 0.3s;
        }

        .url-link:hover {
            background: #0056b3;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 18px;
        }

        .api-notice {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .api-notice h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .api-notice p {
            color: #856404;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .popup-grid {
                grid-template-columns: 1fr;
            }

            .filter-buttons {
                justify-content: center;
            }

            .sort-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .popup-header {
                padding: 15px;
            }

            .popup-title {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸª 9/21 ê³ ê³ ì‹±</h1>
            <p>ë­í•˜ê³  ë†€ê¹Œ</p>
        </div>

        <div class="api-notice" id="apiNotice">
            <h3>ğŸ—ºï¸ ì§€ë„ ê¸°ëŠ¥ ì„¤ì • ë°©ë²•</h3>
            <p>
                ì§€ë„ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì¹´ì¹´ì˜¤ë§µ API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.<br>
                1. <a href="https://developers.kakao.com" target="_blank">https://developers.kakao.com</a>ì—ì„œ ì•± ë“±ë¡<br>
                2. JavaScript í‚¤ ë°œê¸‰<br>
                3. HTMLì˜ ca0816bee0db23ce6c74a1cb0c58b9b4ë¥¼ ë°œê¸‰ë°›ì€ í‚¤ë¡œ êµì²´
            </p>
        </div>

        <div class="controls">
            <div class="view-toggle">
                <button class="view-btn active" onclick="toggleView('list')">ğŸ“‹ ë¦¬ìŠ¤íŠ¸ ë·°</button>
                <button class="view-btn" onclick="toggleView('map')">ğŸ—ºï¸ ì§€ë„ ë·°</button>
            </div>

            <input type="text" class="search-box" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥">

            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">ì „ì²´</button>
                <button class="filter-btn" data-filter="high">ë†’ì€ ìš°ì„ ìˆœìœ„</button>
                <button class="filter-btn" data-filter="ongoing">ì§„í–‰ì¤‘</button>
                <button class="filter-btn" data-filter="reservation">ì˜ˆì•½ í•„ìš”</button>
                <button class="filter-btn" data-filter="beauty">ë·°í‹°</button>
                <button class="filter-btn" data-filter="food">ì‹ìŒë£Œ</button>
            </div>

            <div class="sort-controls">
                <label>ì •ë ¬:</label>
                <select class="sort-select">
                    <option value="smart">ì¶”ì²œìˆœ</option>
                    <option value="priority">ìš°ì„ ìˆœìœ„ìˆœ</option>
                    <option value="date">ê¸°ê°„ìˆœ</option>
                    <option value="name">ì´ë¦„ìˆœ</option>
                    <option value="waiting">ì›¨ì´íŒ… ì‹œê°„ìˆœ</option>
                </select>
            </div>
        </div>

        <div id="mapContainer"></div>

        <div class="popup-grid" id="popupGrid">
            <!-- íŒì—… ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>

        <div class="no-results" id="noResults" style="display: none;">
            ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
        </div>
    </div>

    <!-- ì¹´ì¹´ì˜¤ë§µ APIë¥¼ body ëì—ì„œ ë¡œë“œ -->
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=ca0816bee0db23ce6c74a1cb0c58b9b4&libraries=services&autoload=false"></script>

    <script>
        // ì£¼ì˜: ì‹¤ì œ ì‚¬ìš© ì‹œ ca0816bee0db23ce6c74a1cb0c58b9b4ë¥¼ ë³¸ì¸ì˜ ì¹´ì¹´ì˜¤ë§µ API í‚¤ë¡œ êµì²´í•´ì•¼ í•©ë‹ˆë‹¤
        // https://developers.kakao.com ì—ì„œ ì•± ë“±ë¡ í›„ JavaScript í‚¤ë¥¼ ë°œê¸‰ë°›ìœ¼ì„¸ìš”

        let map = null;
        let markers = [];
        let infoWindows = [];
        let geocoder = null;
        let currentView = 'list';

        const popupData = [
            {
                name: "ëŒ€í•œë¯¼êµ­ í–‰ë³µì¶©ì „ì†Œ",
                period: "9/19(ê¸ˆ)-9/21(ì¼)",
                endDate: "2025-09-21",
                hours: "ë§¤ì¼ 11:00~19:00",
                location: "ì„±ë™êµ¬ ì—°ë¬´ì¥ê¸¸ 18, í”¼ì¹˜ìŠ¤ë„ì› ì„±ìˆ˜",
                content: "[9/19-9/21, 3ì¼ê°„] QR ì´ë²¤íŠ¸ë¡œ ìŠ¤í‹°ì»¤ë¥¼ ëª¨ì•„ ìœ ëª… ìŠ¤íƒ€ê°€ë§¹ì  ë©”ë‰´ë¡œ êµí™˜, ì˜¨ëˆ„ë¦¬ìƒí’ˆê¶Œìœ¼ë¡œ ì„±ìˆ˜ë™ ê°€ë§¹ì  ì´ë²¤íŠ¸",
                events: "í˜„ì¥ ë°©ë¬¸ ì‹œ í‚¤ë§ êµ¿ì¦ˆ, ì „í†µìŒë£Œ, í´ë Œì§• ë°€í¬ ì¦ì •",
                waiting: "ì •ë³´ ì—†ìŒ",
                urls: ["https://www.instagram.com/p/DOubtlSktQY/"],
                priority: "high",
                status: "ongoing",
                category: ["food"],
                waitingTime: 0
            },
            {
                name: "ì¨ëª¨ìŠ¤ í•´í”¼ ë£¨í‹´ ë°ì´",
                period: "9/18(ëª©)~9/28(ì¼)",
                endDate: "2025-09-28",
                hours: "12:00~20:00",
                location: "LES601ì„±ìˆ˜ (ì„±ë™êµ¬ ì—°ë¬´ì¥17ê¸¸ 4)",
                content: "ì´ë‚˜í”¼ìŠ¤í€˜ì–´ ì½œë¼ë³´ ì œí’ˆ ì„ ê³µê°œ, ë£¨í‹´ í”„ë¡œê·¸ë¨ ì²´í—˜, 4ë‹¨ê³„ ë¯¸ì…˜ ì™„ë£Œ í›„ 2ì¸µ ì¹´í˜ ì´ìš©",
                events: "ì „ ì œí’ˆ 30% í• ì¸, ì½œë¼ë³´ ì œí’ˆ êµ¬ë§¤ ì‹œ ë¦¬ìœ ì €ë¸”ë°± 1:1 ì¦ì •, ë§¤ì¼ ì„ ì°©ìˆœ 100ëª… ëŸ­í‚¤ë“œë¡œìš°",
                waiting: "ì›¨ì´íŒ… ê¸°ê³„ ìˆìŒ, ì˜¤í”ˆ 15ë¶„ ì „ ë„ì°© ì¶”ì²œ (ì•ì— 13íŒ€ ëŒ€ê¸°)",
                urls: ["https://m.blog.naver.com/ilsang___gongyu/224007680643", "https://blog.naver.com/hyoniholic"],
                priority: "high",
                status: "ongoing",
                category: ["lifestyle"],
                waitingTime: 15
            },
            {
                name: "NH ì˜¬ì›íƒ€ìš´",
                period: "9/1(ì›”)~9/30(í™”)",
                endDate: "2025-09-30",
                hours: "11:00~19:00",
                location: "NH ì˜¬ì›íƒ€ìš´ íŒì—… (ì„±ë™êµ¬ ì—°ë¬´ì¥13ê¸¸ 11)",
                content: "ì˜¬ì›ë±…í¬ ê°€ì… ì²´í—˜, ê¸ˆê³  ì˜¤í”ˆ ì±Œë¦°ì§€, ìŒ€ê·¸ë¨ ì±Œë¦°ì§€, ê²Œì„ ì²´í—˜",
                events: "ì˜¬ì›ë±…í¬ ê°€ì… ì‹œ ì˜¬ì› ë¶€ìŠ¤í„°, ìŒ€ ì•„ì´ìŠ¤í¬ë¦¼, í¬í† ì¡´ ì‚¬ì§„ ì¸í™” ì„œë¹„ìŠ¤",
                waiting: "ë²ˆí˜¸í‘œ ë°œê¸‰ í›„ ëŒ€ê¸°",
                urls: ["https://m.blog.naver.com/soljeon93/224010686091"],
                priority: "high",
                status: "ongoing",
                category: ["finance"],
                waitingTime: 5
            },
            {
                name: "í•€ë€ë“œ ì˜ì–‘ë¶„ì‹",
                period: "9/12(ê¸ˆ)~9/21(ì¼)",
                endDate: "2025-09-21",
                hours: "12:00~20:00 (ì…ì¥ë§ˆê° 19:30)",
                location: "MMì„±ìˆ˜ (ì„±ë™êµ¬ ì—°ë¬´ì¥ê¸¸ 95)",
                content: "ë¯¸ìŠë­ 3ìŠ¤íƒ€ ì…°í”„ì™€ í‘ë°±ìš”ë¦¬ì‚¬ê°€ ë§Œë“  ì˜ì–‘êµ° ì‹ì¬ë£Œ ë¶„ì‹, ìì‘ë‚˜ë¬´ìˆ² ë¯¸ë””ì–´ì•„íŠ¸, ë°¤í•˜ëŠ˜ ì²´í—˜",
                events: "ìŠ¤íƒ¬í”„íˆ¬ì–´ ì™„ë£Œ ì‹œ íœ˜ë‚­ì‹œì—+ë»¥ìŠ¤í¬ë¦¼, 4ì¢… ë¶„ì‹ì„¸íŠ¸+ì´ˆí™”ì£¼ ì œê³µ",
                waiting: "í˜„ì¥ ëŒ€ê¸° ì‹œ 20-30ë¶„ ì›¨ì´íŒ…",
                urls: ["https://m.blog.naver.com/bariyoone/224011502376", "https://blog.naver.com/realjaekyo"],
                priority: "high",
                status: "ongoing",
                category: ["food"],
                waitingTime: 25,
                reservation: true
            },
            {
                name: "ê¸°ì•„ EV5 X íŒŒì´ë¸Œê°€ì´ì¦ˆ",
                period: "9/12~9/21",
                endDate: "2025-09-21",
                hours: "11:00~20:00",
                location: "ê¸°ì•„ ì–¸í”ŒëŸ¬ê·¸ë“œ ê·¸ë¼ìš´ë“œ (ì„±ë™êµ¬ ìƒì›4ê¸¸ 10)",
                content: "ìŠ¤íƒ¬í”„ íˆ¬ì–´ 5ê°œ ì™„ë£Œ ì‹œ íŒŒì´ë¸Œê°€ì´ì¦ˆ ë²„ê±°/ì‰ì´í¬ ë£°ë › ì´ë²¤íŠ¸, í•˜ë§Œì¹´ëˆ ìŠ¤í”¼ì»¤ ì²´í—˜",
                events: "ë¬´ë£Œ ë•…ì½© ì¦ì •, í•˜ë§Œì¹´ëˆ ìŠ¤í”¼ì»¤ ì¶”ì²¨, ì¸í˜• í‚¤ë§ ì¦ì •",
                waiting: "ì •ë³´ ì—†ìŒ",
                urls: ["https://m.blog.naver.com/yourlunacy/224006403020"],
                priority: "medium",
                status: "ongoing",
                category: ["automotive", "food"],
                waitingTime: 0
            },
            {
                name: "ë°”ë¥¼ íŒì—…",
                period: "9/12~9/21",
                endDate: "2025-09-21",
                hours: "11:00~21:00",
                location: "517ë© (ì„±ë™êµ¬ ì—°ë¬´ì¥ê¸¸ 31-1 1ì¸µ 103í˜¸)",
                content: "ì‹œì¹´ë°¤ë¶€ í† ë„ˆíŒ¨ë“œ, ì°¨ì½œ ë©œíŒ…ë°¤, ì„ ì¿ ì…˜ ì²´í—˜, í‚¤ë§ ë§Œë“¤ê¸°",
                events: "SNS íŒ”ë¡œìš° ì‹œ ìƒ˜í”Œ 3ì¢… ì„¸íŠ¸, êµ¬ë§¤ ì‹œ ìµœëŒ€ 32% í• ì¸ ë° ê°€ì± ",
                waiting: "ì›¨ì´íŒ… íƒœë¸”ë¦¿ ìˆìŒ, ì‚¬ëŒì´ ë§ì§€ ì•Šìœ¼ë©´ í˜„ì¥ ëŒ€ê¸° ì ê¹",
                urls: ["https://m.blog.naver.com/yourlunacy/224007721302"],
                priority: "medium",
                status: "ongoing",
                category: ["beauty"],
                waitingTime: 10
            },
            {
                name: "Treed íŠ¸ë¦¬ë“œ íŒì—…",
                period: "9/17(ìˆ˜)~9/23(í™”)",
                endDate: "2025-09-23",
                hours: "11:00~20:00",
                location: "ë¬´ì‹ ì‚¬ ë·°í‹° ìŠ¤í˜ì´ìŠ¤1 (ì„±ë™êµ¬ ì—°ë¬´ì¥ê¸¸ 81)",
                content: "í•œêµ­ ì „í†µ í–¥ ì²´í—˜, ì‚¬êµ°ì í–¥ í¬í•¨ 5ê°€ì§€ í–¥ ì²´í—˜",
                events: "29CM ì¢‹ì•„ìš” ë° ì¸ìŠ¤íƒ€ íŒ”ë¡œìš° ì‹œ ë‚œì´ˆ ìƒ˜í”Œ í‚¤íŠ¸ ë° ì†Œë‚˜ë¬´ ì—½ì„œ ì¦ì •",
                waiting: "ì •ë³´ ì—†ìŒ",
                urls: ["https://m.blog.naver.com/ilsang___gongyu/224007703825"],
                priority: "medium",
                status: "ongoing",
                category: ["beauty"],
                waitingTime: 0
            },
            {
                name: "ë³´ë‹¤ë‚˜ Born To Blow",
                period: "9/19(ê¸ˆ)~9/21(ì¼)",
                endDate: "2025-09-21",
                hours: "ê¸ˆ 15:00-19:00, í† -ì¼ 11:00-19:00 (ì…ì¥ë§ˆê° 18:30)",
                location: "ì„±ìˆ˜ ë‚¨ì •ë¹Œë”© 1ì¸µ (ì„±ìˆ˜ì´ë¡œ 88)",
                content: "ë³´ë‹¤ë‚˜ ì„±ìˆ˜ ì²« íŒì—…! ë¹›ë‚˜ëŠ” ë””ë°”ì˜ ìŠ¤íƒ€ì¼ ì—¬ì • ì²´í—˜. 5ë‹¨ê³„ ë””ë°” ì²´í—˜ (AI ìºë¦­í„° ìƒì„±, ë…¹ìŒì‹¤ ë¬´ë¹„ ì´¬ì˜, ë°±ìŠ¤í…Œì´ì§€ ìŠ¤íƒ€ì¼ë§, ë©”ì¸ìŠ¤í…Œì´ì§€, ë¦¬ì›Œë“œì¡´), ê¸€ë˜ì–´ ìŠ¤íƒ€ì¼ëŸ¬ í´ë“œ ë“± ì‹ ì œí’ˆ ì²´í—˜",
                events: "ì¹´ì¹´ì˜¤ ì˜ˆì•½ ì‹œ ëŸ¬ë¸”ë¦¬ í—¤ì–´ í´ë¦½, ì¸ìŠ¤íƒ€ íŒ”ë¡œìš° ì‹œ ë¦¬ì›Œë“œ LP í‚¤ë§ + íŠ¸ë¼ì´ì–¼í‚¤íŠ¸, í˜„ì¥ ì‚¬ì§„ ì—…ë¡œë“œ ì‹œ ë³¸í’ˆ ì¶”ì²¨",
                waiting: "",
                urls: ["https://m.blog.naver.com/chi_v_ola/224014515146", "https://blog.naver.com/twinkle__hee"],
                priority: "low",
                status: "ongoing",
                category: ["beauty"],
                waitingTime: 0,
                reservation: true
            },
            {
                name: "íŒŒì¸ë“œì¹´í‘¸ì–´ í”Œë˜ê·¸ì‹­ ìŠ¤í† ì–´",
                period: "9/11~9/30",
                endDate: "2025-09-30",
                hours: "11:00~20:00",
                location: "íŒŒì¸ë“œì¹´í‘¸ì–´ í”Œë˜ê·¸ì‰½ ì„±ìˆ˜ (ì„±ë™êµ¬ ì„±ìˆ˜ì´ë¡œ7ê°€ê¸¸ 23 1ì¸µ, 2ì¸µ)",
                content: "ì‹ ìƒí’ˆ ì²´í—˜ ë° êµ¬ë§¤",
                events: "50% í• ì¸ ì¿ í°, ë‰´ë¯¹ìŠ¤ ë§ì°¨ë¼ë–¼ 2p ë° ì¿ í‚¤ ì¦ì •, êµ¬ë§¤ ê¸ˆì•¡ë³„ ì‚¬ì€í’ˆ",
                waiting: "ì •ë³´ ì—†ìŒ",
                urls: ["https://m.blog.naver.com/yourlunacy/224008690616"],
                priority: "low",
                status: "ongoing",
                category: ["fashion"],
                waitingTime: 0
            },
            {
                name: "2025 ì œë¡œì›ë°ì´ ì „ì‹œ",
                period: "9/17(ìˆ˜)~9/21(ì¼)",
                endDate: "2025-09-21",
                hours: "10:30~20:00",
                location: "í˜„ëŒ€ ì„±ìˆ˜ ë³µí•©ê±°ì  (ì„±ë™êµ¬ ì„±ìˆ˜ì¼ë¡œ6ê¸¸ 10)",
                content: "í¬ë¦¬ì—ì´í„°Â·ìŠ¤íƒ€íŠ¸ì—…Â·í˜„ëŒ€ìë™ì°¨ê·¸ë£¹ ìœµë³µí•© í”„ë¡œì íŠ¸ ì „ì‹œ",
                events: "ì„¤ë¬¸ ì°¸ì—¬ ì‹œ ì»¤í”¼ì¿ í° ì¦‰ì‹œ ì¦ì •",
                waiting: "ì‚¬ì „ì˜ˆì•½ ì—†ì´ ììœ ë¡­ê²Œ ë¬´ë£Œ ì…ì¥",
                urls: ["https://m.blog.naver.com/ilsang___gongyu/224010924052"],
                priority: "low",
                status: "ongoing",
                category: ["exhibition"],
                waitingTime: 0
            },
            {
                name: "ë©”ë””íë¸Œ X ë§ˆì´ë©œë¡œë””",
                period: "9/10~9/22",
                endDate: "2025-09-22",
                hours: "11:00~21:00",
                location: "íŠ¸ë Œë“œíŒŸ ë°”ì´ ì˜¬ë¦¬ë¸Œì˜ ì„±ìˆ˜ (ì„±ë™êµ¬ ì—°ë¬´ì¥7ê¸¸ 13)",
                content: "ë©”ë””íë¸Œ ì—ì´ì§€ì•Œ ë·°í‹° ë””ë°”ì´ìŠ¤ ì²´í—˜, ë§ˆì´ë©œë¡œë”” ì½œë¼ë³´ ì œí’ˆ íŒë§¤",
                events: "SNS íŒ”ë¡œìš° ì‹œ ì œë¡œëª¨ê³µíŒ¨ë“œ 2ë§¤, ì²´í—˜ ë¶€ìŠ¤ ìŠ¤íƒ¬í”„ 2ê°œ ì´ìƒ ì‹œ ì‚¬ì€í’ˆ, êµ¬ë§¤ ì‹œ í• ì¸ì¿ í°",
                waiting: "ì˜ˆì•½ë¶ˆê°€ í˜„ì¥ì›¨ì´íŒ…, ëŒ€ê¸°ì‹œê°„ ì•½ 20ë¶„ (ì™¸êµ­ì¸ ê´€ê´‘ê° ë‹¤ìˆ˜)",
                urls: ["https://m.blog.naver.com/pqwe1003/224011602751"],
                priority: "low",
                status: "ongoing",
                category: ["beauty"],
                waitingTime: 20
            }
        ];

        let filteredData = [...popupData];
        let currentSort = 'smart';

        // ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜
        function initMap() {
            console.log('initMap í•¨ìˆ˜ í˜¸ì¶œë¨');

            // ì¹´ì¹´ì˜¤ë§µì´ ì•„ì§ ë¡œë“œë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë¡œë“œë¥¼ ì‹œë„
            if (!window.kakao || !window.kakao.maps) {
                console.log('ì¹´ì¹´ì˜¤ë§µ APIë¥¼ ë¡œë“œí•©ë‹ˆë‹¤...');

                // kakao.maps.loadë¥¼ ì‚¬ìš©í•˜ì—¬ API ë¡œë“œ
                kakao.maps.load(function() {
                    console.log('ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œ ì™„ë£Œ');
                    initMapCore();
                });
            } else {
                initMapCore();
            }
        }

        // ì‹¤ì œ ì§€ë„ ì´ˆê¸°í™” ì½”ì–´ í•¨ìˆ˜
        function initMapCore() {
            console.log('initMapCore í•¨ìˆ˜ í˜¸ì¶œë¨');
            console.log('window.kakao:', window.kakao);
            console.log('window.kakao.maps:', window.kakao ? window.kakao.maps : 'undefined');

            if (!window.kakao || !window.kakao.maps) {
                console.error('ì¹´ì¹´ì˜¤ë§µ APIê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                alert('ì§€ë„ë¥¼ í‘œì‹œí•˜ë ¤ë©´ ì¹´ì¹´ì˜¤ë§µ API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.\n\n1. https://developers.kakao.com ì—ì„œ ì•± ë“±ë¡\n2. JavaScript í‚¤ ë°œê¸‰\n3. HTMLì˜ ca0816bee0db23ce6c74a1cb0c58b9b4ë¥¼ ë°œê¸‰ë°›ì€ í‚¤ë¡œ êµì²´');
                return;
            }

            console.log('ì¹´ì¹´ì˜¤ë§µ API ì‚¬ìš© ê°€ëŠ¥');

            const mapContainer = document.getElementById('mapContainer');
            console.log('mapContainer:', mapContainer);

            if (!mapContainer) {
                console.error('ì§€ë„ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const mapOption = {
                center: new kakao.maps.LatLng(37.5447, 127.0557), // ì„±ìˆ˜ë™ ì¤‘ì‹¬ ì¢Œí‘œ
                level: 5
            };

            console.log('ì§€ë„ ìƒì„± ì‹œë„ ì¤‘...');
            try {
                map = new kakao.maps.Map(mapContainer, mapOption);
                console.log('ì§€ë„ ìƒì„± ì™„ë£Œ:', map);

                geocoder = new kakao.maps.services.Geocoder();
                console.log('Geocoder ìƒì„± ì™„ë£Œ:', geocoder);

                // ëª¨ë“  íŒì—… ìœ„ì¹˜ë¥¼ ì§€ë„ì— í‘œì‹œ
                addMarkersToMap();
            } catch (error) {
                console.error('ì§€ë„ ìƒì„± ì‹¤íŒ¨:', error);
                alert('ì§€ë„ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ì£¼ì†Œë¥¼ ì¢Œí‘œë¡œ ë³€í™˜í•˜ê³  ë§ˆì»¤ ì¶”ê°€
        function addMarkersToMap() {
            console.log('addMarkersToMap í•¨ìˆ˜ í˜¸ì¶œë¨');
            console.log('geocoder:', geocoder);
            console.log('filteredData:', filteredData);

            if (!geocoder) {
                console.error('Geocoderê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
            markers.forEach(marker => marker.setMap(null));
            infoWindows.forEach(infoWindow => infoWindow.close());
            markers = [];
            infoWindows = [];

            filteredData.forEach((popup, index) => {
                console.log(`ì²˜ë¦¬ ì¤‘: ${popup.name} - ${popup.location}`);

                // ì£¼ì†Œë¥¼ ì¢Œí‘œë¡œ ë³€í™˜
                geocoder.addressSearch(popup.location, function(result, status) {
                    console.log(`ì£¼ì†Œ ê²€ìƒ‰ ê²°ê³¼ (${popup.name}):`, result, status);

                    if (status === kakao.maps.services.Status.OK) {
                        const coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                        // ë§ˆì»¤ ìƒì„±
                        console.log(`ë§ˆì»¤ ìƒì„± ì‹œë„: ${popup.name}`, coords);

                        const marker = new kakao.maps.Marker({
                            map: map,
                            position: coords,
                            title: popup.name
                        });

                        console.log(`ë§ˆì»¤ ìƒì„± ì™„ë£Œ: ${popup.name}`, marker);

                        // ìš°ì„ ìˆœìœ„ì— ë”°ë¥¸ ìƒ‰ìƒ
                        const priorityColors = {
                            'high': '#ffb3b3',
                            'medium': '#ffd9b3',
                            'low': '#c8e6c9'
                        };

                        // ì¸í¬ìœˆë„ìš° ë‚´ìš©
                        const iwContent = `
                            <div class="map-info-window">
                                <div class="map-info-title">${popup.name}</div>
                                <div class="map-info-hours">${popup.hours}</div>
                                <div class="map-info-priority" style="background: ${priorityColors[popup.priority]}">
                                    ${popup.priority === 'high' ? 'ê³ ê³ ì‹±' : popup.priority === 'medium' ? 'ê°ˆë§Œí•œë“¯' : 'ì‹œê°„ë˜ë©´'}
                                </div>
                                <br>
                                <a href="#" class="map-info-link" onclick="showPopupDetail('${popup.name}'); return false;">ìƒì„¸ì •ë³´</a>
                            </div>
                        `;

                        // ì¸í¬ìœˆë„ìš° ìƒì„±
                        const infoWindow = new kakao.maps.InfoWindow({
                            content: iwContent,
                            removable: true
                        });

                        // ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸
                        kakao.maps.event.addListener(marker, 'click', function() {
                            console.log('ë§ˆì»¤ í´ë¦­ë¨:', popup.name);
                            // ëª¨ë“  ì¸í¬ìœˆë„ìš° ë‹«ê¸°
                            infoWindows.forEach(iw => iw.close());
                            // í´ë¦­í•œ ë§ˆì»¤ì˜ ì¸í¬ìœˆë„ìš° ì—´ê¸°
                            infoWindow.open(map, marker);
                        });

                        markers.push(marker);
                        infoWindows.push(infoWindow);
                    } else {
                        console.error(`ì£¼ì†Œ ê²€ìƒ‰ ì‹¤íŒ¨ (${popup.name}):`, status, popup.location);
                    }
                });
            });

            console.log('ë§ˆì»¤ ì¶”ê°€ ì™„ë£Œ. ì´ ë§ˆì»¤ ìˆ˜:', markers.length);
        }

        // íŒì—… ìƒì„¸ì •ë³´ í‘œì‹œ (ë¦¬ìŠ¤íŠ¸ ë·°ë¡œ ì „í™˜í•˜ê³  í•´ë‹¹ ì¹´ë“œ í™•ì¥)
        function showPopupDetail(popupName) {
            toggleView('list');

            // í•´ë‹¹ íŒì—… ì¹´ë“œ ì°¾ì•„ì„œ í™•ì¥
            setTimeout(() => {
                const cards = document.querySelectorAll('.popup-card');
                cards.forEach(card => {
                    const data = JSON.parse(card.dataset.popup);
                    if (data.name === popupName) {
                        card.classList.add('expanded');
                        card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                });
            }, 100);
        }

        // ë·° ì „í™˜ í•¨ìˆ˜
        function toggleView(view) {
            currentView = view;

            const listBtn = document.querySelector('.view-btn[onclick*="list"]');
            const mapBtn = document.querySelector('.view-btn[onclick*="map"]');
            const mapContainer = document.getElementById('mapContainer');
            const popupGrid = document.getElementById('popupGrid');
            const apiNotice = document.getElementById('apiNotice');

            if (view === 'map') {
                listBtn.classList.remove('active');
                mapBtn.classList.add('active');
                mapContainer.style.display = 'block';
                popupGrid.style.display = 'none';
                apiNotice.style.display = 'none';

                // ì§€ë„ê°€ ì•„ì§ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ì´ˆê¸°í™”
                if (!map) {
                    initMap();
                } else {
                    // ì§€ë„ í¬ê¸° ì¬ì¡°ì •
                    setTimeout(() => {
                        map.relayout();
                    }, 100);
                }
            } else {
                listBtn.classList.add('active');
                mapBtn.classList.remove('active');
                mapContainer.style.display = 'none';
                popupGrid.style.display = 'grid';
                apiNotice.style.display = 'block';
            }
        }

        function getStatusBadge(status) {
            const statusMap = {
                'ongoing': { class: 'status-ongoing', text: 'ì§„í–‰ì¤‘' },
                'ending': { class: 'status-ending', text: 'ë§ˆê°ì„ë°•' },
                'ended': { class: 'status-ended', text: 'ì¢…ë£Œ' }
            };
            const statusInfo = statusMap[status] || statusMap['ended'];
            return `<span class="status-badge ${statusInfo.class}">${statusInfo.text}</span>`;
        }

        function getPriorityBadge(priority) {
            const priorityMap = {
                'high': { class: 'priority-high', text: 'ê³ ê³ ì‹±' },
                'medium': { class: 'priority-medium', text: 'ê°ˆë§Œí•œë“¯' },
                'low': { class: 'priority-low', text: 'ì‹œê°„ë˜ë©´' }
            };
            const priorityInfo = priorityMap[priority] || priorityMap['low'];
            return `<span class="priority-badge ${priorityInfo.class}">${priorityInfo.text}</span>`;
        }

        function getWaitingInfo(waiting, waitingTime) {
            if (waiting === "ì •ë³´ ì—†ìŒ") return '';
            return `
                <div class="waiting-info">
                    <span class="waiting-icon">â°</span>
                    <strong>ì›¨ì´íŒ… ì •ë³´:</strong> ${waiting}
                </div>
            `;
        }

        function createPopupCard(popup) {
            const urlLinks = popup.urls.map((url, index) =>
                `<a href="${url}" target="_blank" class="url-link">í›„ê¸° ${index + 1}</a>`
            ).join('');

            return `
                <div class="popup-card" data-popup='${JSON.stringify(popup)}'>
                    <div class="popup-header" onclick="toggleCard(this)">
                        <div>
                            <div class="popup-title">${popup.name}</div>
                            <div style="font-size: 12px; margin-top: 5px;">${popup.hours}</div>
                        </div>
                        <div style="text-align: right;">
                            ${getPriorityBadge(popup.priority)}
                            <div class="expand-icon">â–¼</div>
                        </div>
                    </div>
                    <div class="popup-content">
                        <div class="popup-details">
                            <!-- ${getStatusBadge(popup.status)} -->

                            <div class="detail-section">
                                <div class="detail-label">ğŸ“ ìœ„ì¹˜</div>
                                <div class="detail-value">${popup.location}</div>
                            </div>

                            <div class="detail-section">
                                <div class="detail-label">ğŸ• ìš´ì˜ì‹œê°„</div>
                                <div class="detail-value">${popup.hours}</div>
                            </div>

                            <div class="detail-section">
                                <div class="detail-label">ğŸ“ ë‚´ìš©</div>
                                <div class="detail-value">${popup.content}</div>
                            </div>

                            <div class="detail-section">
                                <div class="detail-label">ğŸ ì´ë²¤íŠ¸</div>
                                <div class="detail-value">${popup.events}</div>
                            </div>

                            ${getWaitingInfo(popup.waiting, popup.waitingTime)}

                            <div class="detail-section">
                                <div class="detail-label">ğŸ”— ê´€ë ¨ ë§í¬</div>
                                <div class="url-links">${urlLinks}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function toggleCard(header) {
            const card = header.closest('.popup-card');
            card.classList.toggle('expanded');
        }

        function renderPopups(data) {
            const grid = document.getElementById('popupGrid');
            const noResults = document.getElementById('noResults');

            if (data.length === 0) {
                grid.style.display = 'none';
                noResults.style.display = 'block';
            } else {
                grid.style.display = 'grid';
                noResults.style.display = 'none';
                grid.innerHTML = data.map(createPopupCard).join('');
            }
        }

        function sortData(data, sortBy) {
            const sorted = [...data];

            switch(sortBy) {
                case 'smart':
                    // ë³µí•© ì •ë ¬: ìš°ì„ ìˆœìœ„ì™€ ì¢…ë£Œì¼ ê°€ì¤‘ì¹˜ ì¡°í•©
                    const priorityWeight = { 'high': 3, 'medium': 2, 'low': 1 };
                    const today = new Date('2025-09-20');
                    return sorted.sort((a, b) => {
                        // ë‚¨ì€ ë‚ ì§œ ê³„ì‚° (0-10ì¼ ìŠ¤ì¼€ì¼)
                        const daysLeftA = Math.max(0, Math.min(10, (new Date(a.endDate) - today) / (1000 * 60 * 60 * 24)));
                        const daysLeftB = Math.max(0, Math.min(10, (new Date(b.endDate) - today) / (1000 * 60 * 60 * 24)));

                        // ì¢…ë£Œ ì„ë°•ì¼ìˆ˜ë¡ ë†’ì€ ì ìˆ˜ (10ì  ë§Œì )
                        const timeScoreA = 10 - daysLeftA;
                        const timeScoreB = 10 - daysLeftB;

                        // ìš°ì„ ìˆœìœ„ ì ìˆ˜ (10ì  ë§Œì ìœ¼ë¡œ ë³€í™˜)
                        const priorityScoreA = priorityWeight[a.priority] * 3.33;
                        const priorityScoreB = priorityWeight[b.priority] * 3.33;

                        // ë³µí•© ì ìˆ˜ (ìš°ì„ ìˆœìœ„ 60%, ì‹œê°„ 40% ê°€ì¤‘ì¹˜)
                        const totalScoreA = (priorityScoreA * 0.6) + (timeScoreA * 0.4);
                        const totalScoreB = (priorityScoreB * 0.6) + (timeScoreB * 0.4);

                        return totalScoreB - totalScoreA;
                    });
                case 'priority':
                    const priorityOrder = { 'high': 3, 'medium': 2, 'low': 1 };
                    return sorted.sort((a, b) => priorityOrder[b.priority] - priorityOrder[a.priority]);
                case 'date':
                    return sorted.sort((a, b) => new Date(a.endDate) - new Date(b.endDate));
                case 'name':
                    return sorted.sort((a, b) => a.name.localeCompare(b.name));
                case 'waiting':
                    return sorted.sort((a, b) => a.waitingTime - b.waitingTime);
                default:
                    return sorted;
            }
        }

        function filterData(data, filter) {
            switch(filter) {
                case 'all':
                    return data;
                case 'high':
                    return data.filter(popup => popup.priority === 'high');
                case 'ongoing':
                    return data.filter(popup => popup.status === 'ongoing');
                case 'reservation':
                    return data.filter(popup => popup.reservation);
                case 'beauty':
                    return data.filter(popup => popup.category.includes('beauty'));
                case 'food':
                    return data.filter(popup => popup.category.includes('food'));
                default:
                    return data;
            }
        }

        function searchData(data, searchTerm) {
            if (!searchTerm) return data;

            const term = searchTerm.toLowerCase();
            return data.filter(popup =>
                popup.name.toLowerCase().includes(term) ||
                popup.content.toLowerCase().includes(term) ||
                popup.location.toLowerCase().includes(term)
            );
        }

        function updateDisplay() {
            let result = [...popupData];

            // ê²€ìƒ‰ ì ìš©
            const searchTerm = document.querySelector('.search-box').value;
            result = searchData(result, searchTerm);

            // í•„í„° ì ìš©
            const activeFilter = document.querySelector('.filter-btn.active').dataset.filter;
            result = filterData(result, activeFilter);

            // ì •ë ¬ ì ìš©
            const sortBy = document.querySelector('.sort-select').value;
            result = sortData(result, sortBy);

            filteredData = result;
            renderPopups(result);

            // ì§€ë„ ë·°ê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ë§ˆì»¤ ì—…ë°ì´íŠ¸
            if (currentView === 'map' && map) {
                addMarkersToMap();
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.querySelector('.search-box').addEventListener('input', updateDisplay);

        document.querySelector('.sort-select').addEventListener('change', updateDisplay);

        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                updateDisplay();
            });
        });

        // ì´ˆê¸° ë Œë”ë§
        updateDisplay();
    </script>
</body>
</html>